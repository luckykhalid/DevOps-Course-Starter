env:
  global:
  - secure: JjbU69ZIQ63AoiN9iBwg3QdbVOmV/mJKdv62CjaliD1iP7Szm0mr8ZZ3zpquxdi+JCVzBqc9nQOmKBtSc+DAK3dtFnr/zq6kboSEexzj92orBgsB4fLyJKky8I0POTLyv/6CGEWKfuF1g1XFjHou/8DQLc6YQ6JSn/lIojPXuJrawb7Dz9HXq87SAZH43m5UPnev0JhlI1ePZiWPPPsgeDKCewioUBWafjx1O6NlI3Ael093HYlST+RgzW4mAWK1j3/fAHLlQlOn6yW+VvZhyaqToQ0cyqM0GQYIwo53q/ssjiUeaiEQKI7qpH/zhxfHaRJ0qfHrBxnMf69WC08V1DjlBuUwKOuWDU9VxeCcXFYxHdPApSmw68C5bMr7baaYeHmUrpeldox6gFyElxj8QLiFAFIEC4Qi3x24m8er8FtP8dPgSyfttBdF6znAPQFDKWPA4XuIN2x9IARbITElcH0tEAg8YmkK0ImCANV3x/gzMlRSyEiUzI3o+IYtmf66xa4yvW2ldCfFWaTAPIbVSPOKHCm+SFZEhfP8YbagTpzJGkHEmuG7ezMmBkN/F12jwNS1zE0w4KDF0TvaRjgzltawvKmuE5fy9pp3QHGy6m5W+b8v/NwneM4f7EifXXwMNAAxEbiFwSEaZHqNQaodAq/QIdBKqv0NJfbj+UJD08k=
  - secure: jNHdzr7rkikMAuh84maYSW5rFc9tQ1mZ8/gXHKCGnBXp6sUYNQka1rem5V/u+YC3hqE9UM1PpGKkFvYmXISxhMbVav/+p4IpLmZP3AedaytnyUqUUkgZlc7Wpns1EzCmCSNbX2tZTM2bfMnWN9F5kG0GSoxTIW6GQa2uCxXo9YynsVCqqQrHjM/pYuJ8s/8b7qAAjk+nQITn/cxoDaEnXG2VnOrA3JRLUuWY0ZsOhzEQOwMg6tGGIpaLBTNCQaLMdJ6lUkGS7r/KY777M+2wjEKL8K00oPJPqgf1oWQkglMVO/6z+0MgHdKknPErSZQmZIUQehpgggdFrXVUiZ0IlAANKMflWd4msw2GRlV7hkllRk41483E7dPBG/O2Rs5Gdr3ebbxgF2oiTqjhkDrX3yr41TOq3rjYRwKR+qpJcHpY46DV+PI1axUgazhDkQS7G+qWXSnp+0sgwxnX/yu2X5Gsho7xv+pWpn0Q/7VIdwido7+hBxXHVtC9vwLJYaSJxXwrhOFH4qqsM+Iu4bLHs7HCrcKDo3vGWqoqiqo2+0TAsvsaRW6CgLPWZgcNqbZiG9K8q1V4anoUDQNotl/p7dvZ8al2wDkLvkdj1cloT3eON6TY6c6cdNa0JmKZmvPCRNxCfcBd1FlHWdSmKq6cuc3luKOtTn8Pd94/nyjmtLQ=
  - secure: XHT1owdpyeIYbQK5RGPUYtDgIKYUFfjc4EhUbcsi/UNKpaDCnjNAc4NOfK+G6kOwdFbm7uT47DftrOo5bPUwKRu+MyvBuSshC6IZXYK2NqBa+l2sQV9DwhwFOJqQkKF3wOefDqHFZ0dwf/EqBX/EOVoNfT71oGxBsVtcsJ9nIS0C6Ds0SFmC4l9Sns/ma7n2zcKg1S7MIfr7oKSp8MS0x2I5N/V9CSZc5CJRDxizdji0KE0KwCno6mG9p88OYbwfOfbcEz828RVNZaBoGJ4M57fUPCLcou+bfVtndA8haLfQBV1poi9yiWIMxH7lIEXN2LUdw27kF+Pr+ufYvhykm9rnMdG1zeqQA656QSeqOwU0tyISxyqBQFH7yE0TK62ZJ1aFk4ObJprKNuh4Z/+1IICbRmiRNVXNUs9IawTi9CrwCygHaeyjt0YcZ6X+CHLJj+UYM6kmQowmSm1hhB13J3NG0lqyqAf6tbwLDbCK/cOarb8o8DGyYfHVsjxDkJyIb6LrBCXBpC5aZZNkK1Mbbh3f0nUz+KpiREfW3GubkG5ue5dGUEUnAWaQh9chlEtBd429dr813HklBEpXbRoLSoBDjqIfS29ovoZBKQu0dBE7SyBEnvYxGowYXds0KUZJULqC6SYXO+E0D539G/e1YrXaShyoSDySrS0i0fV53ls=
  - secure: c01xDbsRil3IT7lAAiBO1VOye2QEcaK091mudiNAhFjVCmoiA9x6s4Xn9Shh0tZsM6LZmLth8yuEJb8YLLIZto9Gjq9QbIotQjdarJIVkka8TmxZ9xUVQTvEiaM8hLYdZrxnz6dWK/TdmulteW/YohTIwYz2WbBWpG9jXL/gUL3/v+cKSvbuDZmKUU+ANn2cs8CNw14jSy3KOAeklS9TTx+JZqc6PEUnJKKabk0lxyhKKXCArszRzZh2xOWH8EZKYKE6bvB5vZWRGrEV4JMOT4AdNlXC5peQrHB8sQQiZPNFKX+lPxgO1ClRZfEYpW4v1n0HGYOv92RyJ8vqPzXY3WDL4jDPgmFp/KQErgVx8h3oVAZbiIzL3Tu5OTk0lW59TjMjI5BoaesCY1iQZwfAtKA2OBmNGCDIPP6wi0wHKdr9FcZdGbMtI7jLlUHeA+Axf5pd2ImwOYOKrdEhTdBBHBp5lvCv1hnNUynePhu7Jhix+ejQNlzZVWSt3vw2qF/ZjsXk0NCFTXPrS3LC2yQGXT2jbpCxRgx3rZhIFsssIOrlwSpMpnS3O3uIXD7WtKUegvMbKlfgTyg4Pz3IQw2bcerdEI+m7g5MvXqkhd7BZjohPBnbKuw7tv5xoxCeaf8+kqzXS3lYaHXC/pyLlBRo08QwPmpd5sNWLENhxCSa/Yo=
  - DOCKER_USER=khalidashraf
  - secure: WrccS5O4eSH8/HKUukA+cJxa+2wCkj/f4lYgWBeGFpoX2xFVICYiYfp5cHSL6VYFCieq24LCufdhB7JvJ+JWjbmmrElC4aluNSfRgpwQBlN7OTVmMwCEzII3Uu8tIww8md7/mIdG/6YBSDPWFPo17tFI69bx0t1AXUWts3WLHTuVilp3EFrlZXpnUKR3d91hSQ+9hG3UnGP8fLAlC/D2b/3gVuCZ7tv9zrcQWh4zFDYIjxT6SKeiOOwwlC9i9qGb6pcDxFxHjMVgXtLU1ue6Gh9KPXyd3WRyPmKd/mxrH8qCw6tad+/gsSk25Vkue+dKQs8F4+Qkc8L2IwcdwIq8ty12Wfu2Wc7GSC7mSCdwq1AySRqOVcAWIlCSGPHP7Rv3bC7RQ0i1CQaRlV4ch/3LfXBva1DfFG01gAKqimmwvT0yCxN8g+MT7pnYfSofnCFFZsuCpahyT1B36wkB9hBAxeUYRO1vi1+scu48J++YfXBqXyvgZm+CnsHv1UsWAYdt5YT1VRnOumJ564wZS64x4MUyKqsFDZvdpB6VICmtwJYk2fcQ4UQ1jL6Hvkezqh7BJew1Osw3LSRr3Y/90iywMAF70/bEKS0E3s2xZVVfblxDOEtlBoEFIgNyBR/TX2fQ2Vi2xo9i0gtV8JtFmwUaYnKzmEsckGaTSyruuYAgbjs=
  - HEROKU_APP=khalidashraf-todo-app  
services:
- docker
  
script:  
  # Build test image and test the code
  - docker build --target test --tag todo_app:test .
  - docker run --env-file .env.test todo_app:test tests
  - docker run -e SECRET_KEY -e MONGO_USER -e MONGO_PASS todo_app:test tests_e2e

deploy:
  provider: script
  script: bash ./build-deploy.sh
  on:
    branch: master

notifications:
  slack:
    secure: o5cEaHOFMzW435cV5zT/4MaoyHC3X3DS9091yDH6SxwLy6F/rngAy5EwDZ53opq/YdWYyGhlumsiZFfVyI2qpyZSkE2Epk9p35YT0Gdx/x9oad91G8PeyaWSBN2GWfceZ/qBxTfamyACUPr2ItWi7oPw65RnYM/kRcbfmXnxC9bqQcDX0bLWVDRZtVmmsZJ0kNnCwznsBb9gpVV7Vz3ZVhv9QvFoYPyIDdyMT2vlYHu/iQ8FJIX9eKuYuqViklUiwWYIejUqp7892x3m5Bywm7e0Y0NqXmWbXsiW8MizQsn9E6M93Ed4+xNyKWz7f6O7GvVZm1GmdyH5FPB3Nz38FxOy6e4bYC8r399DJISZl0VMYtqDhKndoqRvSpR4tvvmad5x37mAMs2o1IpRc2OQTJ5Rtz54Hqw+gAHa3lvyFuz1QvMjaZnp9zXLy6dJYF6VIJu6FKDKQJwLbiYio18EqkxauxUGM0VB+12JiVds53aXNqlPkqopzhNdCKnSUlKH0yho6SJzzyYRnKG9vOGaIbx88Sf+PrEIYylXdFlsfH/I3bhFMkRN2EoHZpYaaDXPqxk/IXCUHNHU39cuu9CpQYFXt3rlirljBD/o2Oi3oiMXT36jFL37Oc4C3jxiv2cj0LLacgB/e0qwGqhjqjLerKiYPjh1vvdOt9aGvpXcIAA=
  email:
    recipients:
    - khalid.ashraf@hotmail.com
    on_success: never
    on_failure: always
